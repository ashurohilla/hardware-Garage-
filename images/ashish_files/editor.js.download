function createNewEvent(e){var n=null;return"function"==typeof Event?n=new Event(e):(n=document.createEvent("Event")).initEvent(e,!0,!0),n}function getModeForFileName(e,n){var t=null;switch(e.substr(e.lastIndexOf(".")+1).toLowerCase()){case"c":case"cc":case"h":case"hpp":case"cpp":t="ace/mode/c_cpp";break;case"py":t="ace/mode/python";break;case"java":t="ace/mode/java";break;case"go":t="ace/mode/golang";break;case"rs":t="ace/mode/rust";break;case"cs":t="ace/mode/csharp";break;case"vb":t="ace/mode/vbscript";break;case"php":t="ace/mode/php";break;case"rb":t="ace/mode/ruby";break;case"swift":t="ace/mode/swift";break;case"bash":t="ace/mode/sh";break;case"r":t="ace/mode/r";break;case"pl":t="ace/mode/perl",n.indexOf("prolog")>-1&&(t="ace/mode/prolog");break;case"js":t="ace/mode/javascript";break;case"sql":t="ace/mode/sql";break;case"pas":t="ace/mode/pascal";break;case"f95":t="ace/mode/fortran";break;case"hs":t="ace/mode/haskell";break;case"m":t="ace/mode/objectivec";break;case"S":t="ace/mode/assembly_x86";break;case"html":t="ace/mode/html";break;case"js":t="ace/mode/javascript";break;case"css":t="ace/mode/css";break;case"xml":t="ace/mode/xml"}return null==t&&(t=n),t}function get_os(){var e="Unknown OS";return-1!=navigator.appVersion.indexOf("Win")?e="Windows":-1!=navigator.appVersion.indexOf("Mac")?e="MacOS":-1!=navigator.appVersion.indexOf("X11")?e="UNIX":-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e}function is_mac_os(){return"MacOS"==get_os()}function FileLine(){this.filename="",this.line=-1}function FileLine(e,n){return this.filename=e,this.line=n,this}function Breakpoint(){return FileLine.call(this),this}function Breakpoint(e,n){return FileLine.call(this,e,n),this}!function(e){"use strict";var n=ace.require("ace/range").Range;function t(t){var i=t.target,a=[],o=[],r=null,s=t.theme?t.theme:"ace/theme/idle_fingers",c=t.fontsize?t.fontsize:"medium",f=t.langmode?t.langmode:"ace/mode/c_cpp",l=t.tabsize?t.tabsize:4,d=void 0===t.autocomplete||t.autocomplete,u=(t.socket&&t.socket,function(n){var t=e(n.target).attr("href");console.log(t),t.indexOf("editor")>-1&&(console.log("editor focused:",t),ide.editor.resizeAndFocus(t.split("#")[1],1))});function m(n){var t=ace.edit(n);t.getSession().setTabSize(l),t.setFontSize(c),t.setTheme(s),t.getSession().setMode(getModeForFileName(y(n),f)),is_mac_os()&&t.commands.bindKey("Ctrl-P","golineup"),t.setOptions({enableBasicAutocompletion:d,enableSnippets:!0,enableLiveAutocompletion:d}),v(n),t.on("guttermousedown",function(n){!function(n){var t=n.domEvent.target;if(-1==t.className.indexOf("ace_gutter-cell"))return;if(n.clientX>25+t.getBoundingClientRect().left)return;var i=n.getDocumentPosition().row,o=t,r=null;console.log(t);for(;e(o)&&-1==e(o).attr("class").indexOf("editor");)o=e(o).parent();e(o)&&e(o).attr("class").indexOf("editor")&&(r=e(o).attr("id"));if(!r)throw"Couldn't find editor DOM through ace_gutter";if(-1==t.className.indexOf("ace_breakpoint")){a[r].getSession().setBreakpoint(i);var s=y(r),c=createNewEvent("breakpoint_set");c.breakpoint=new Breakpoint(s,i+1),dispatchEvent(c)}else{a[r].getSession().clearBreakpoint(i);var s=y(r),c=createNewEvent("breakpoint_unset");c.breakpoint=new Breakpoint(s,i+1),dispatchEvent(c)}n.stop()}(n)}),t.on("change",function(e){A(e)}),a[n]=t,r&&r(t)}var h=function(){return i.find(".editor_file_tabs")},p=function(){return i.find(".editor_text_panes")},v=function(e){h().find('a[href="#'+e+'"]').parent().find(".menu_item_rename").on("click",function(){b(e)}),h().find('a[href="#'+e+'"]').parent().find(".menu_item_delete").on("click",function(){k(e)})},g=function(e,n){console.log("handle_edit_file_input:",n);var t=g_renamefilemodal_get_edit_filename(),i=M(t);i?g_renamefilemodal_error_message(i):(F(n,t),g_renamefilemodal_hide())},b=function(e){g_renamefilemodal_popup({default_name:y(e),title:"Rename File"},g,e)},k=function(n){e("#delete_file_name").text(y(n)),e("#deleteFileModal .modal-body .btn-ok").off("click").on("click",function(e){_(e,n)}),e("#deleteFileModal").modal("show")},_=function(n,t){w(t),e("#deleteFileModal").modal("hide")};function w(e){delete a[e];var n=null,t=h().find('a[href="#'+e+'"]').parent().prev(),i=h().find('a[href="#'+e+'"]').parent().next();n=i.length?i:t,h().find('a[href="#'+e+'"]').parent().remove(),p().find("#"+e).remove(),n&&n.find("a").tab("show"),A()}var y=function(e){return h().find('a[href="#'+e+'"] .filename').text()},F=function(e,n){h().find('a[href="#'+e+'"] .filename').text(n)},E=function(e){for(var n in a)if(y(n)==e)return a[n];return null},x=function(e){if(e instanceof FileLine)return E(e.filename);throw"Not an instance of FileLine"},L=function(e){return!(e.indexOf("/")>-1)},B=function(e){if("string"!=typeof e)throw"Invalid filename";var n,t="_editor_"+Math.ceil(999999999*Math.random())+1;return function(e,n){var t='<li><a href="#'+e+'" data-toggle="tab"><span class="filename">'+(n=(n=n||"untitled").trim())+'</a><div class="dropdown"><span class="dropbtn glyphicon glyphicon-option-vertical"></span><div class="dropdown-content" style="left:-50px;"><a href="#" class="menu_item menu_item_rename">Rename</a><a href="#" class="menu_item menu_item_delete">Delete</a></div></div></li>';h().append(t)}(t,e),n='<div class="tab-pane active editor"             style="position: absolute;   width:100%;    top: 52px;    bottom: 0px;"            id="'+t+'"></div>',p().append(n),m(t),h().find('a[href="#'+t+'"]').tab("show"),h().find('a[data-toggle="tab"]').on("shown.bs.tab",function(e){u(e)}),A({change:"new_file",editor:a[t]}),t};function M(e){return""==e?"Please enter a filename.":""==e.trim()?"Filename shouldn't contain only whitespace.":L(e)?!!V(e)&&"File already exists. Please choose different name":"'/' isn't allowed in filename."}function O(n){var t=e("#new_file_name").val(),i=M(t);i?e("#newFileModal .error_message").text(i):(e("#newFileModal").modal("hide"),B(t))}var S=function(n){var t=null;return"string"==typeof n&&(t=n),t?B(t):(e("#new_file_name").off("keypress").keypress(function(e){if(13==e.which)return e.preventDefault(),O(),!1}),e("#newFileModal .modal-body .btn-ok").off("click").on("click",function(e){O()}),e("#newFileModal .error_message").text(""),e("#new_file_name").val("untitled"),e("#newFileModal").modal("show"),e("#newFileModal").off("shown.bs.modal").on("shown.bs.modal",function(){e("#new_file_name").focus(),e("#new_file_name").select()}),null)},N=function(e){var n={};return n.name=y(e),n.content=function(e){return a[e].getValue()}(e),n},j=function(e){var n=E(e.name);if(!n){var t=S(e.name);n=a[t]}n.setValue(e.content),n.gotoLine(1,0,!1)},z=function(e){for(var n in a)if(y(n)==e)return n},V=function(e){for(var n in a)if(y(n)==e)return!0;return!1};function A(e){dispatchEvent(new CustomEvent("change",{detail:e}))}function C(){var e=h().find("li.active a").attr("href").split("#")[1];return console.log("Active editor:",e),y(e)}function I(){var e=h().find("li.active a").attr("href").split("#")[1];return a[e]}function P(e){var n=x(e);console.log("gotoFileLine:",JSON.stringify(e)),n&&(!function(e){if(console.log("focus_file:",e),e!=C()){console.log("focus_file:prev:",C());var n=z(e);h().find('a[href="#'+n+'"]').tab("show")}}(e.filename),n.gotoLine(e.line,0,!1))}this.addEventListener=function(e,n,t){t=t||!1,addEventListener(e,n,t)},this.new_editor=function(){return S()},this.compare_file=function(e){var n=this.get_file_by_name(e.name);return!!n&&n.content==e.content},this.get_file_by_name=function(e){var n=z(e);return n?N(n):null},this.get_files=function(){var e=[];for(var n in a)e.push(N(n));return e},this.clear_all_editors=function(){h().html(""),p().html("")},this.set_files=function(e){for(var n=0;n<e.length;n++)j(e[n])},this.delete_file=function(e){var n=z(e);n&&w(n)},this.setReadOnly=function(e){for(var n in a)a[n].setReadOnly(e)},this.getBreakpoints=function(){var e=[];for(var n in a){var t={};t.eid=n,t.filename=y(n),t.breakpoints=a[n].getSession().getBreakpoints(),e[t.filename]=t}return e},this.if_file_exists=function(e){return V(e)},this.setBreakpoint=function(e){if(!(e instanceof Breakpoint))throw"Not a Breakpoint instance";E(e.filename).getSession().setBreakpoint(e.line-1)},this.clearBreakpoint=function(e){if(!(e instanceof Breakpoint))throw"Not a Breakpoint instance";E(e.filename).getSession().clearBreakpoint(e.line-1)},this.forEachBreakpoint=function(e){if(e&&"function"==typeof e){var n=this.getBreakpoints();for(var t in n){var i=n[t].breakpoints;for(var a in i){e(new Breakpoint(t,parseInt(a)+1))}}}},this.forEachEditor=function(e,n){var t=!1;if(void 0!==n&&(t=n),"function"==typeof e){for(var i in a)e(a[i],i);t&&(r=e)}},this.setModeForLang=function(e){e||(e="");var n="ace/mode/c_cpp";switch(e.toLowerCase()){case"python":n="ace/mode/python";break;case"java":n="ace/mode/java";break;case"c#":n="ace/mode/csharp";break;case"vb":n="ace/mode/vbscript";break;case"php":n="ace/mode/php";break;case"ruby":n="ace/mode/ruby";break;case"perl":n="ace/mode/perl";break;case"r":n="ace/mode/r";break;case"bash":n="ace/mode/sh";break;case"swift":n="ace/mode/swift";break;case"prolog":n="ace/mode/prolog";break;case"js_rhino":n="ace/mode/javascript";break;case"sqlite3":n="ace/mode/sql";break;case"pascal":n="ace/mode/pascal";break;case"fortran":n="ace/mode/fotran";break;case"haskell":n="ace/mode/haskell";break;case"objc":n="ace/mode/objectivec";break;case"asm_gcc":n="ace/mode/assembly_x86";break;case"html":n="ace/mode/html";break;case"rust":n="ace/mode/rust";break;case"go":n="ace/mode/golang"}f=n,this.forEachEditor(function(e,n){var t=y(n);e.getSession().setMode(getModeForFileName(t,f))},!1)},this.setTheme=function(e){s=e,this.forEachEditor(function(n){n.setTheme(e)},!1)},this.setKeyboardHandler=function(e){this.forEachEditor(function(n){n.setKeyboardHandler(e)},!1)},this.setFontSize=function(e){c=e,this.forEachEditor(function(n){n.setFontSize(e)},!1)},this.setTabSize=function(e){l=e,this.forEachEditor(function(n){n.getSession().setTabSize(e)},!1)},this.setAutocomplete=function(e){d=e,this.forEachEditor(function(n){n.setOptions({enableBasicAutocompletion:e,enableLiveAutocompletion:e})})},this.resize=function(){this.forEachEditor(function(e){e.resize()},!1)},this.getBreakpointsList=function(){var e=[],n=[];for(var t in a)n[y(t)]=a[t].getSession().getLength();return this.forEachBreakpoint(function(t){t.line<=n[t.filename]&&e.push(t)}),e},this.gotoFileLine=function(e){P(e)},this.addMarker=function(e,t,i){var a=x(e);if(console.log("Addmarker:",JSON.stringify(e),t,i),a){var r=e.line,s=t||"",c=i||"fullLine",f=function(e,n,t){return e.filename+":"+e.line+"_"+n+"_"+t}(e,s,c),l=a.session.addMarker(new n(r-1,0,r-1,1),s,c);return o[f]={eid:z(e.filename),id:l},console.log("Addmarker:",f),f}},this.removeMarkerById=function(e){if(void 0!==e&&e in o){var n=o[e].eid,t=a[n];if(t){var i=o[e].id;t.getSession().removeMarker(i)}delete o[e]}},this.focus=function(e){a[e].focus()},this.resizeAndFocus=function(e){this.resize(e),this.focus(e)},this.gotoLineInEditor=function(e,n){a[e].gotoLine(n,0,!1)},this.getValue=function(){return I().getValue()},this.setValue=function(e){I().setValue(e)},this.gotoLine=function(e){I().gotoLine(e,0,!1)},this.focus=function(){I().focus()},this.getCursorPosition=function(){return I().getCursorPosition()},this.getFile=function(){var e={};return e.filename=C(),e.content=I().getValue(),e},this.setOptions=function(e){for(var n in a)a[n].setOptions(e)},this.hideCursor=function(){for(var e in a)a[e].renderer.$cursorLayer.element.style.display="none"};this.setFileName=function(e,n){n=n.trim(),h().find('a[href="#'+e+'"] .filename').text(n)},this.set_default_editor_filename=function(e){if("string"!=typeof e)throw"Invalid filename";this.setFileName("editor_1",e)},this.set_default_editor_content=function(e){if("string"!=typeof e)throw"Invalid content";var n=a.editor_1;n.setValue(e),n.gotoLine(1,0,!1)},i.find(".editor").each(function(){m(this.id)}),h().find('a[data-toggle="tab"]').on("shown.bs.tab",function(e){u(e)})}jQuery.fn.editor=function(){return new t({target:e(this[0])})}}(jQuery);